sources:
  datadog_agent:
    address: 0.0.0.0:8282
    type: datadog_agent
    multiple_outputs: true
transforms:
  # This transform exists because of how the Datadog Agent classifies
  # logs that it collects from containers. The `status` attribute ends
  # up overriding whatever other parsing the Datadog backend might do
  # of the message to determine if it's an error log, for instance.
  remove_status:
    type: remap
    inputs:
      - datadog_agent.logs
    source: |-
      del(.status)
sinks:
  datadog_logs:
    type: datadog_logs
    inputs:
      - remove_status
    default_api_key: ${DD_API_KEY}
    compression: gzip
  datadog_metrics:
    type: datadog_metrics
    inputs:
      - datadog_agent.metrics
    default_api_key: ${DD_API_KEY}
